---
phase: 01-foundation-infrastructure
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - Imagile.Framework.sln
  - src/Imagile.Framework.EntityFrameworkCore.Testing/Imagile.Framework.EntityFrameworkCore.Testing.csproj
autonomous: true

must_haves:
  truths:
    - "Solution file named Imagile.Framework.sln exists at repository root"
    - "Testing package uses Imagile.Framework.EntityFrameworkCore.Testing namespace"
    - "NuGet package ID is Imagile.Framework.EntityFrameworkCore.Testing"
    - "Sample projects are removed from solution"
    - "Project builds successfully with new naming"
  artifacts:
    - path: "Imagile.Framework.sln"
      provides: "Main solution file for framework"
      contains: "Imagile.Framework.EntityFrameworkCore.Testing"
    - path: "src/Imagile.Framework.EntityFrameworkCore.Testing/Imagile.Framework.EntityFrameworkCore.Testing.csproj"
      provides: "Renamed convention testing package"
      contains: "PackageId"
  key_links:
    - from: "Imagile.Framework.sln"
      to: "src/Imagile.Framework.EntityFrameworkCore.Testing/Imagile.Framework.EntityFrameworkCore.Testing.csproj"
      via: "Project reference in solution"
      pattern: "Project.*Imagile.Framework.EntityFrameworkCore.Testing"
---

<objective>
Restructure project to use Imagile.Framework.* naming convention with proper folder organization.

Purpose: Establish clean multi-package structure following Microsoft conventions (Microsoft.EntityFrameworkCore pattern) with src/ folder for framework packages.

Output: Renamed solution and project with updated namespaces, ready for additional packages.
</objective>

<execution_context>
@C:\Users\kolat\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\kolat\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md
@Imagile.EntityFrameworkCore.sln
@Imagile.EntityFrameworkCore.Tests/Imagile.EntityFrameworkCore.Tests.csproj
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create new solution and move/rename project</name>
  <files>
    Imagile.Framework.sln
    src/Imagile.Framework.EntityFrameworkCore.Testing/Imagile.Framework.EntityFrameworkCore.Testing.csproj
  </files>
  <action>
**Step 1: Create src directory structure**
```bash
mkdir src
mkdir src/Imagile.Framework.EntityFrameworkCore.Testing
```

**Step 2: Move existing project files to new location**
Move all files from Imagile.EntityFrameworkCore.Tests/ to src/Imagile.Framework.EntityFrameworkCore.Testing/:
- Configuration/ folder
- Infrastructure/ folder
- Rules/ folder
- ConventionViolation.cs
- DbContextConventionTests.cs

**Step 3: Rename and update .csproj file**
Rename Imagile.EntityFrameworkCore.Tests.csproj to Imagile.Framework.EntityFrameworkCore.Testing.csproj

Update the csproj with:
- PackageId: Imagile.Framework.EntityFrameworkCore.Testing
- RootNamespace: Imagile.Framework.EntityFrameworkCore.Testing
- AssemblyName: Imagile.Framework.EntityFrameworkCore.Testing
- Remove Version, Authors, Company (now in Directory.Build.props)
- Remove RepositoryUrl, RepositoryType, PackageLicenseExpression (now in Directory.Build.props)
- Keep Description and PackageTags (package-specific)
- Update README path in PackageReadmeFile to ..\..\README.md

**Step 4: Create new solution file**
Run from repository root:
```bash
dotnet new sln -n Imagile.Framework
dotnet sln Imagile.Framework.sln add src/Imagile.Framework.EntityFrameworkCore.Testing/Imagile.Framework.EntityFrameworkCore.Testing.csproj
```

**Step 5: Update namespace declarations**
Update all .cs files in src/Imagile.Framework.EntityFrameworkCore.Testing/ to use:
```csharp
namespace Imagile.Framework.EntityFrameworkCore.Testing
```
Instead of:
```csharp
namespace Imagile.EntityFrameworkCore.Tests
```
  </action>
  <verify>
Run `dotnet build Imagile.Framework.sln` - should compile successfully with new namespaces.
  </verify>
  <done>
New solution exists at Imagile.Framework.sln. Project renamed and moved to src/Imagile.Framework.EntityFrameworkCore.Testing/. All namespaces updated. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean up old structure and update documentation references</name>
  <files>
    README.md
    CLAUDE.md
    .github/workflows/ci.yml
    .github/workflows/publish-nuget.yml
  </files>
  <action>
**Step 1: Remove old solution and project directory**
```bash
rm Imagile.EntityFrameworkCore.sln
rm -rf Imagile.EntityFrameworkCore.Tests/
rm -rf Samples/
```

**Step 2: Update README.md**
Update project structure section to reflect new layout:
- Change Imagile.EntityFrameworkCore.Tests/ to src/Imagile.Framework.EntityFrameworkCore.Testing/
- Remove Samples/ section
- Update package name references from Imagile.EntityFrameworkCore.Tests to Imagile.Framework.EntityFrameworkCore.Testing
- Update GitHub repository references from imagile-entityframeworkcore to imagile-framework

**Step 3: Update CLAUDE.md**
Update all references to match new structure:
- Project paths
- Package names
- Namespace references

**Step 4: Update GitHub Actions workflows**
In ci.yml:
- Update project path in dotnet build/test commands to src/Imagile.Framework.EntityFrameworkCore.Testing/

In publish-nuget.yml:
- Update project path for dotnet pack command
- Update package name pattern for nuget push

**Step 5: Verify no broken references**
Search codebase for old names "Imagile.EntityFrameworkCore.Tests" and "imagile-entityframeworkcore" to ensure all updated.
  </action>
  <verify>
1. `git status` shows removed old files, added new structure
2. `dotnet build Imagile.Framework.sln` passes
3. `grep -r "Imagile.EntityFrameworkCore.Tests"` finds no matches except in git history
4. README.md references correct package name
  </verify>
  <done>
Old solution and sample projects removed. Documentation updated with new package names. GitHub Actions workflows updated with correct paths. No references to old naming remain.
  </done>
</task>

</tasks>

<verification>
1. `ls Imagile.Framework.sln` - solution exists
2. `ls src/Imagile.Framework.EntityFrameworkCore.Testing/` - project directory exists with all files
3. `dotnet build Imagile.Framework.sln` - builds successfully
4. `dotnet pack src/Imagile.Framework.EntityFrameworkCore.Testing/` - creates Imagile.Framework.EntityFrameworkCore.Testing.nupkg
5. Old directories (Imagile.EntityFrameworkCore.Tests/, Samples/) do not exist
6. Grep for old namespace returns no results in source files
</verification>

<success_criteria>
- Imagile.Framework.sln exists at repository root
- src/Imagile.Framework.EntityFrameworkCore.Testing/ contains renamed project
- All .cs files use Imagile.Framework.EntityFrameworkCore.Testing namespace
- `dotnet build` and `dotnet pack` succeed
- No orphaned references to old naming scheme
- Documentation accurately reflects new structure
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-infrastructure/01-02-SUMMARY.md`
</output>
